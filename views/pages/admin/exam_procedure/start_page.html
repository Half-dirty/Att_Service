<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <title>–í—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∫ —ç–∫–∑–∞–º–µ–Ω—É</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../../style/style.css">
    <link rel="stylesheet" href="../../../style/admin/exam_procedure.css">
</head>

<body data-role="chairman" data-id="{{.id}}" data-name="{{.name}}" data-exam-id="{{.exam_id}}">
    <div class="wrapper">
        <main class="main main--exam">
            <section class="exam__window">
                <div class="exam__body">
                    <div class="exam__speach-container">
                        <h1>–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω–∞—è —Ä–µ—á—å</h1>
                        <div class="exam__speach-text">
                            <p>
                                –£–≤–∞–∂–∞–µ–º—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —ç–∫–∑–∞–º–µ–Ω–∞!<br>
                                –ú—ã —Ä–∞–¥—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞—Å –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ –ø–æ —Ä—É—Å—Å–∫–æ–º—É –∂–µ—Å—Ç–æ–≤–æ–º—É —è–∑—ã–∫—É.
                                –≠—Ç–æ—Ç —ç–∫–∑–∞–º–µ–Ω —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω—ã–º —ç—Ç–∞–ø–æ–º –≤ –≤–∞—à–µ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –∫–∞—Ä—å–µ—Ä–µ.
                                –ú—ã –∂–µ–ª–∞–µ–º –≤–∞–º —É–¥–∞—á–∏ –∏ —É—Å–ø–µ—Ö–æ–≤! –ù–∞–¥–µ–µ–º—Å—è, —á—Ç–æ –≤—ã –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –Ω–∞–∏–ª—É—á—à–∏–º
                                –æ–±—Ä–∞–∑–æ–º.
                            </p>
                        </div>
                    </div>
                    <div class="exam__start">
                        <a href="#" class="exam__start-button examiner-list-btn">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–¥–∫–ª—é—á–∏–≤—à–∏—Ö—Å—è</a>
                    </div>
                </div>
            </section>
        </main>
        <footer class="footer"></footer>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../../../scripts/admin_script.js"></script>
    <script src="../../../scripts/socket.js"></script>
    <script>
        $(document).ready(function () {
            const role = $("body").data("role");
            const id = $("body").data("id");
            const name = $("body").data("name");
            const examId = $("body").data("exam-id");

            if (role && id && name && examId) {
                initSocket(role, id, name, examId);
            }

            $(document).on('click', '.examiner-list-btn', function (e) {
                e.preventDefault();

                if ($('#start-exam').length === 0) {
                    openModal('start-exam'); // –°–æ–∑–¥–∞—ë–º –º–æ–¥–∞–ª–∫—É
                } else {
                    $('#start-exam').addClass('popup__open');
                    $('body').addClass('modal');
                }

                // üî• –í—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ (—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ) –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ–±—ã —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑–∞—Ç—å
                openStartExamModal(lastExaminerList);

                if (socket && socket.readyState === WebSocket.OPEN) {
                    socket.send(JSON.stringify({ type: "request_examiner_list" })); // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
                } else {
                    console.error("–°–æ–∫–µ—Ç –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω");
                }
            });

            $(document).on('click', '#start_exam_confirm', function (e) {
                e.preventDefault();

                const examId = $("body").data("exam-id");
                if (!examId) {
                    console.error("–ù–µ—Ç examID");
                    return;
                }

                window.location.href = `/user/exam/start/${examId}`;
            });

        });
    </script>
</body>

</html>